{
  "title": "Contract: input-seeded wildcard output",
  "description": "Uses a typed input signature with CASE fallback logic and dynamic-key conservatism for wildcard output inference.",
  "program": [
    "TRANSFORM Normalize(input: { payload?: { name: text }, metrics: { count: number }, key: text }) -> _ {",
    "    LET fallbackName = CASE {",
    "        WHEN input.payload != NULL THEN input.payload.name",
    "        ELSE \"none\"",
    "    }",
    "    LET count = GET(input.metrics, \"count\", 0)",
    "    OUTPUT {",
    "        name: fallbackName,",
    "        count: count,",
    "        dynamic: input.metrics[input.key]",
    "    }",
    "}"
  ],
  "input": {
    "payload": {
      "name": "Eugene"
    },
    "metrics": {
      "count": 4,
      "extra": "9"
    },
    "key": "extra"
  }
}
