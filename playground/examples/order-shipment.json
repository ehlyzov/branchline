{
  "title": "Order shipment overview",
  "description": "Extract shipping operations data with GET/FORMAT and CASE-based rush classification.",
  "program": [
    "LET primaryItem = LISTIFY(input.items)[0] ?? {}",
    "LET shippingAddress = input.shipping.address ?? {}",
    "",
    "OUTPUT {",
    "    order_id: input.id,",
    "    customer_email: GET(input.customer, \"email\", \"unknown@example.com\"),",
    "    rush_order: CASE {",
    "        WHEN input.shipping.priority == \"rush\" THEN true",
    "        ELSE false",
    "    },",
    "    primary_sku: GET(primaryItem, \"sku\", \"none\"),",
    "    shipping_label: FORMAT(\"{line1}, {city}\", {",
    "        line1: GET(shippingAddress, \"line1\", \"unknown\"),",
    "        city: GET(shippingAddress, \"city\", \"unknown\")",
    "    })",
    "}"
  ],
  "input": {
    "id": 50231,
    "customer": {
      "email": "lea@example.com"
    },
    "shipping": {
      "priority": "rush",
      "address": {
        "line1": "500 Market Street",
        "city": "San Francisco"
      }
    },
    "items": [
      {
        "sku": "tee-olivine",
        "quantity": 1
      },
      {
        "sku": "hoodie-midnight",
        "quantity": 2
      }
    ]
  }
}
